import{aK as l,r as c,p as d,aq as f}from"./client-Dxsqy_tD.js";import{u as m}from"./useQuery-CFxh-fuH.js";const b=(e,s)=>{const{data:t,isLoading:a}=m({queryKey:[e,s],queryFn:async()=>l(e,s),enabled:!!s}),[r,i]=c.useState(t);return c.useEffect(()=>{t!==r&&i(t)},[t,r]),c.useEffect(()=>{let o=!0;return(async()=>{try{await d.collection(e).subscribe("*",u=>{o&&(console.log("Realtime event:",u.action,u.record),f.invalidateQueries({queryKey:[e]}))})}catch(u){console.error("Realtime subscription failed:",u)}})(),()=>{o=!1,d.collection(e).unsubscribe()}},[e]),{data:r,isLoading:a}},p=e=>{const[s,t]=c.useState(0),{data:a,isLoading:r}=b("products",e);return{data:a,isLoading:r,selectedImageIndex:s,setSelectedImageIndex:t,handleNext:()=>{a?.imageurl&&s<a.imageurl.length-1&&t(n=>n+1)},handleBack:()=>{s>0&&t(n=>n-1)}}};export{p as u};
